---
id: implementKvibID
title: Utvide KVIB
description: Utvide Kvib
slug: /omKvib/expandKvib
displayed_sidebar: OmKvibSidebar
sidebar_position: 3
---

## Teknisk struktur

Her kommer det en beskrivelse av den tekniske strukturen til KVIB. KVIB er bygget med dokumentasjonsverktøyet Docusaurus. [Her finner du dokumentasjonen til Docusaurus.](https://docusaurus.io/docs)

### Prosjektstrukturen til KVIB

Slik ser filtreet til KVIB ut på et overordnet nivå:

```markdown 
kvib
├─ .docusaurus
├─ .github
│  ├─ workflows
├─ blog
│  ├─ 2022-07-08-version-[0.0.5].mdx
├─ docs
│  ├─ designsystems
│  │  ├─ designTokens
│  │  ├─ Komponenter
│  ├─ omKvib
├─ node_modules
├─ src
│  ├─css
│  ├─ docusaurus_custom_css
│  ├─ html
├─ static
│  ├─ gif
│  ├─ img
│  ├─ .nojekyll
├─ .gitignore
├─ babel.config.js
├─ docusaurus.config.js
├─ package.json
├─ package-lock.json
├─ README.md
├─ sidebars.js
├─ tsconfig.json
```

### CSS

#### CSS-styling av komponenter og design tokens

CSS-filer til komponenter og design tokens ligger under _src/css_. Dersom du skal lage en ny _.css_ fil, må du lenke filen i _main.css_ som vist under:

```markdown title='src/css/main.css'
/* HovedCSS */
@import 'farger.css';
@import 'buttons.css';
```

#### CSS-styling av dokumentasjonssider

Dersom selve dokumentasjonssiden skal ha styles etter egne preferansen, skal CSS-filene for dette legges under src/docusaurus_custom_css. Husk å lenke filene i custom.css:
```markdown title='src/docusaurus_custom_css/custom.css'
CSS-filene for styling av selve dokumentasjonssiden ligger under _src/docusaurus_custom_css_. Husk å lenke filene i _custom.css_:
```markdown
@import './filnavn.css';
```

I _docusaurus.config.js_ er _custom.css_ lenket under <code>theme</code> i <code>presets</code> for at eget design i dokumentasjonen skal tas i bruk.

### Dokumentasjon

Dokumentasjon ligger under docs-mappen som _.mdx_ filer. Herunder ligger dokumentasjon av komponenter og design tokens under _docs/designsystems_, og dokumentasjon om KVIB under _docs/omKvib_.

Ved opprettelse av ny _.mdx_ fil skal filens <code>id</code>, <code>title</code>, <code>description</code>, <code>slug</code>, <code>displayed_sidebar</code> og <code>sidebar_position</code> ligge øverst i filen. Se eksempel for radioknapp under:
```markdown title='docs/designsystems/Komponenter/radiobuttons.mdx'
---
id: radiobuttonID                            /* dokumentets ID brukes blant annet til å legge .mdx-filen i sidemenyen */
title: Radioknapp                            /* tittelen som vises på siden */
description: Oversikt over radioknapper som blir brukt i Kartverket sine løsninger.
slug: /designsystem/komponenter/radiobutton  /* filstien til .mdx filen */                  
displayed_sidebar: designsystemSidebar       /* for å vise filen i sidebaren til designsystems */
sidebar_position: 3                          /* setter posisjonen i sidebaren */
---

Dokumentasjon HER
```

Se [Innhold og struktur i dokumentasjon](#innhold-og-struktur-i-dokumentasjon) for hvordan nye komponenter og design tokens skal dokumenteres.

#### Dokumentasjon av komponenter som krever Javascript

Per i dag støtter ikke _.mdx_ <code><script\></code>-elementet. Av den grunn finnes det en mappe for HTML-filer under _src/html_, for å vise oppførselen til komponentene. [Se Innhold for hvordan komponenter som krever Javascript kan dokumenteres.](#innhold)


### docusaurus.config.js

Denne seksjonen omhandler innholdet i _docusaurus.config.js_. I denne filen er det mulig å endre utseende til KVIB og distribusjon av nettsiden, samt eksternt innhold som bilder hentes inn.


#### Navigasjonsmeny og footer

Navigasjonsmenyen øverst, footer nederst på siden og deres utseende kan endres ved å redigere innholdet i <code>themeConfig</code> i _docusaurus.config.js_. Merk at visse elementer i kildekoden nedenfor er fjernet for å gi mer oversikt.

```markdown title='docusaurus.config.js'
themeConfig:
/** @type {import('@docusaurus/preset-classic').ThemeConfig} */
      ({
        /* utseende for navigasjonsmeny og footer*/
        colorMode: {
          defaultMode: 'light',
          disableSwitch: true,              /* gjemmer knappen for dark/lightmode */
          respectPrefersColorScheme: false, /* endre til true for å sette egne brukerpreferanser */
        },
        /* EKSEMPEL - Legge inn element i navigasjonsmenyen */
        navbar: {
          items: [
            {
              type: 'doc',
              docId: 'folder/dokumentID',
              position: 'LEFT, RIGHT, CENTER',
              label: 'NAVN PÅ SIDEN',
            },
            {
              type: 'doc',
              docId: 'designsystems/sizesID',
              position: 'left',
              label: 'Designsystem',
            },
            /* Alternativt kan denne syntaksen brukes hvis det kun skal navigeres til én side */
            {to: 'SIDE SOM SKAL NAVIGERES TIL', label: 'NAVN PÅ NAVIGASJONSELEMENT', position: 'LEFT, RIGHT, CENTER'},
            {to: 'blog', label: 'Versjoner', position: 'left'},
          ],
        },
        footer: {
          style: 'dark',
          links: [
            {
              title: 'Docs',
              items: [
                {
                  label: 'KVIB Figma',
                  to: '/',
                },
              ],
            },
            {
              title: 'More', /* navn på navigasjonselement */
              /* Her legges elementer under 'More' */
              items: [
                {
                  label: 'GitHub',
                  href: '#',
                },
              ],
            },
          ],
        },
        prism: {
          theme: CodeTheme,  /* her settes fargene på kodeblokkene, se variabel CodeTheme øverst i filen for tema som hentes ut */
        },
      }),
};
```

#### Sidepaneler

KVIB har et høyre og et venstre sidepanel. Høyre sidepanel genereres når overskriftene <code><h2\></code> (##) og <code><h3\></code> (###) legges inn i _.mdx_ filen.

Venstre sidepanel endres ved å gå inn på _sidebars.js_. Docusaurus kan autogenerere et sidepanel fra filstrukturen. Denne metoden kan tas i bruk ved få elementer i sidepanelet.
```markdown title='sidebars.js'
const sidebars = {
  /* NavnPåSidepanel: [{type: 'autogenerated', dirName:'FOLDER INNHOLDET LIGGER UNDER'}] */

  /*--EKSEMPEL--*/
  OmKvibSidebar: [{type: 'autogenerated', dirName:'omKvib'}]
}
```

Ved mange elementer skal sidepanelet konstrueres selv:
```markdown title='sidebars.js'
/*---EKSEMPEL--- 
  Ett nivå i sidepanelet.
*/

const sidebars = {
    designsystemSidebar: [
    {
      type: 'doc',
      id:'designsystems/sizesID',
      label: 'Elementstørrelser', // Label til sidebar
    }
}



/*---EKSEMPEL---
  Flere nivåer i sidepanelet.
*/

const sidebars = {
 designsystemSidebar: [
    /* NIVÅ 1 */
    {
      type: 'category',
      label: 'Komponenter', // Label til sidebar
      link: {
        type: 'generated-index',
        title: 'Komponenter',
        description: 'Her er en oversikt over utvalget av komponenter i KVIB.' +
            ' Disse er bygget er blant annet bygget opp ved bruk av desing tokens fra KVIB, eksempelvis farger og typografi. I dokumentasjonen følger beskrivelse av komponenten og bruksområde, sammen med kodeeksempler. ',
        slug: '/designsystem/Komponenter',
      },
      items: [
        /* Dokument som skal være under 'Design tokens'. For å hente .mdx-fil; skriv path inkludert IDen.
        'folder/folder/dokumentID' */
        'designsystems/Komponenter/checkboxID',
        'designsystems/Komponenter/inputfeltID',
        'designsystems/Komponenter/dropDownID',
        'designsystems/Komponenter/sliderID',
        'designsystems/Komponenter/radiobuttonID',
        'designsystems/Komponenter/sideelementerID',
        'designsystems/Komponenter/navID',
        'designsystems/Komponenter/tableID',
        ],
        /* NIVÅ 2 */
        {
          type: 'category',
          label: 'Knapper', // Label til sidebar
          items: [
            'designsystems/Komponenter/Knapper/grønnknappID',
            'designsystems/Komponenter/Knapper/blåknappID',
            'designsystems/Komponenter/Knapper/ikonknappID',
            'designsystems/Komponenter/Knapper/disabledknappID',
          ],
        },
      ],
    },
  ],

};

```

#### Ikoner og bilder

Ikonene i KVIB hentes via stylesheets i _docusaurus.config.js_ slik:
```markdown title='docusaurus.config.js'
stylesheets: [
    {
      href: 'https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200',
    },
  ],
```

Bilder og GIFs ligger i static-mappen, blant annet Kartverkets logoer og bilder som brukes til dokumentasjon av komponenter med Javascript. Denne mappen lenkes til i _docusaurus.config.js_ slik:
```markdown title='docusaurus.config.js'
  staticDirectories: ['src/js', 'static'],
```

## Rutine for kvalitetskontroll

Før hver merge til master, skal følgende punkter gjennomføres: 

1. Følge KVIB sine konvensjoner for CSS-klassenavn. [Se Konvensjoner for CSS-klassenavn.](../#konvensjoner-for-css-klassenavn)

2. Følge KVIB sine konvensjoner for dokumentasjon (struktur og innhold). [Se Innhold og struktur av dokumentasjon.](#innhold-og-struktur-i-dokumentasjon)

3. Sjekke rettskriving og klarspråk.


4. Teste med skjermleser:
    - NVDA


5. Teste med browserverktøy:
    - Wave for UU-testing
    - Lighthouse for beste praksis


6. Teste i ulike browsere:
    - Chrome / chromium
    - Firefox
    - Safari


7. Teste med 400% zoom på desktop, samt teste på små skjermer.


8. Test at tab-navigering på siden funger korrekt. 


9. Det skal være QA på all ny kode.

10. Oppdater versjonsloggen. [Se Oppdater versjon.](#oppdater-versjon)





## Innhold og struktur i dokumentasjon

### Struktur av dokumentasjonen


* Følg alltid overskriftsnivåene nedover, selv om dette nødvendigvis ikke gir riktig størrelse. Begynn med <code><h2\></code> (##) ettersom sidetittelen, <code><h1\></code>, settes i beskrivelsen av _.mdx_ filen (øverst i filen) ved bruk av “title”. 

* Vær opppmerksom på hvor mye innhold som blir i _.mdx_ filen. Vurder å eventuelt dele opp innholdet i flere _.mdx_ filer, og legg de samlet i en fellesmappe. Dette genererer et til undernivå i venstre sidebar (eks. se hvordan dette er løst med knapper). 
En slik strukturering gir mindre scrolling på samme side, og samtidig mer oversikt i høyre sidebar ettersom den kun viser element <code><h2\></code> og <code><h3\></code>.


 
### Innhold
Få alltid godkjent komponenter av designer før det legges inn i KVIB. Dokumentasjon av en komponent skal inneholde: 

* Beskrivende heading: Bruk mest naturlige heading-element, avhengig av sturkturen på resten av siden, som tittel på den spesifikke komponenten


* Lag en liten beskrivelse av komponenten under heading


* Vis utseende til komponenten ved å skrive HTML-kode med tilhørende CSS-klasser


* Vis tilhørende HTML-kode under komponenten ved å bruke en kodeblokk uten tittel (_ ‘''markup <….> '’'_ )


* Tillegg for komponenter som krever Javascript
    - Lag en GIF for å vise animert funksjonalitet. (Ta skjermopptak av animasjonen, og deretter konverter til en GIF. Vanlig konvertering av HTML til GIF fungerer ikke i alle tilfeller). Legg GIF inn i dokumentasjon
    - Legg evt inn ekstra statiske bilder med beskrivende teskt for å vise flere variasjoner av komponenten



![documenting_example](/img/image_docs/documenting_example.PNG)



## Oppdater versjon
Det er viktig å holde en riktig og oppdatert versjonslogg, slik at det skal bli enklere for brukere av KVIB å kunne se endringer som har blitt gjort mellom hver versjon av biblioteket. Seksjonen øverst i dokumentet viser en oversikt over kommendene endringer.
I versjonsloggen skal den nyeste versjonen stå øverst sammen med utgivelsesdato.

Versjonering følger [konvensjoner fra Semantic Versioning](https://semver.org/). 
Hovedsakelig inkrementerer patch-versjon ved bakover kompatibel bug-fix, minor-versjon ved ny bakover kompatibel funksjonalitet og major-versjon ved funksjonalitet som ikke er bakover kompatibel.  

 
For hver endring som gjøres, skal den nye versjonen dokumenteres:

* Legg til ny _.mdx_ fil under _kvib/blog_, med filnavn: **YYYY-MM-DD-version[major.minor.patch].mdx **(formatet gjør at dato generes automatisk)

* Følg strukturen fra eksisterende filer i blog-mappen for å lage en beskrivelse øverst i filen:

    - Sett _"title: Versjon [major.minor.patch]"_. 

    - Skriv kort beskrivelse for _.mdx_ filen. 

    - Sett passende _tags_. 

* Skriv en beskrivelse av endringer som er gjort i versjonen ved å bruke titlene (sett som <code><h2\></code>):

    - Added: nye funksjoner som er lagt til 

    - Changed: endringer som er gjort

    - Deprecated: funksjoner som snart skal fjernes. 
    
    - Removed: funskjoner som er fjernet. 

    - Fixed: bugs som er fikset. 
    
    - Security: dersom det er sårbarheter i koden.


## Publisering av ny CSS-pakke
For å publisere ny versjon av KVIB-CSS til GitHub Packages:
1. Trykk på GitHub Actions i KVIB GitHub repository

1. Trykk på Github Actions i Kvib Github repository

2. Velg  "KVIB Package publish"

3. Trykk på "Run workflow" på Master branch.

Ny versjon av KVIB-CSS blir opprettet som GitHub Package og gjort klar til bruk.

## Publisering til GitHub Pages
GitHub Pages bruker gh-pages branchen som kilde.

GitHub actions workflow "Deploy to GitHub Pages" er opprettet for å publisere til GitHub Pages.
Ved push til master branchen, "Test deployment" workflow kjører et build test og etter godkjenning vil "Deploy to GitHub Pages" bli aktivert.
